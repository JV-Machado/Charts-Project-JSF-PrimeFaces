<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:f="http://xmlns.jcp.org/jsf/core"
	xmlns:p="http://primefaces.org/ui"
	xmlns:ui="http://xmlns.jcp.org/jsf/facelets">
<h:head>
	<meta charset="UTF-8" />
	<title>Gráficos</title>
</h:head>
<h:outputStylesheet library="styles" name="style.css" />
<h:body>

	<h2>Biblioteca de Jogos</h2>

	<div id="conteudo">

		<f:metadata>
			<f:viewAction action="#{chartBean.allGames}" />
			<f:viewAction action="#{chartBean.allConsoles}"/>
			<f:viewAction action="#{chartBean.quantityGamesGenrePerConsole}"/>
		</f:metadata>

		<h:form>
			<p:toolbar>
				<f:facet name="left">
					<p:inputText placeholder="Pesquisar por Jogo" size="20" value="#{chartBean.searchTerm}"/>
					<p:spacer width="10px" />
					<p:commandButton value="Pesquisar" icon="fa fa-search" actionListener="#{chartBean.search}" update="gamesDataTable"/>

					<span class="ui-separator"> <span
						class="ui-icon fa fa-ellipsis-v" />
					</span>

					<p:commandButton value="Consoles" icon="fa fa-bar-chart-o" oncomplete="PrimeFaces.widgets.consoleDialogWidgetVar.show()" update="consoleDialog"
					/>
					<span class="ui-separator"> <span
						class="ui-icon fa fa-ellipsis-v" />
					</span>

					<p:commandButton value="Jogos" icon="fa fa-pie-chart" oncomplete="PrimeFaces.widgets.gameDialogWidgetVar.show()" update="gameDialog"/>
				</f:facet>
			</p:toolbar>

			<p:dataTable id="gamesDataTable" value="#{chartBean.listGames}"
				var="game" paginator="true" rows="10" paginatorPosition="bottom">
				<p:column headerText="Jogo" sortBy="#{game.name}">
					<h:outputText value="#{game.name}" />
				</p:column>

				<p:column headerText="Console" sortBy="#{game.gameConsole.name}">
					<h:outputText value="#{game.gameConsole.name}"/>
				</p:column>

				<p:column headerText="Gênero" sortBy="#{game.genre}">
					<h:outputText value="#{game.genre}" />
				</p:column>

				<p:column headerText="Ano de Lançamento" sortBy="#{game.releaseYear}">
					<h:outputText value="#{game.releaseYear}" />
				</p:column>
			</p:dataTable>
			
			<p:dialog id="consoleDialog" header="Gráficos para Consoles" widgetVar="consoleDialogWidgetVar" modal="true" closeOnEscape="true" resizable="false">
				<h:panelGrid columns="2">
					<p:commandButton value="Gráfico de Pizza" icon="fa fa-pie-chart" action="#{chartBean.chartOption('consolePieChart')}" update="charts"/>
					<p:commandButton value="Gráfico de Barras" icon="fa fa-bar-chart-o" action="#{chartBean.chartOption('consoleBarChart')}" update="charts"/>
				</h:panelGrid>
				<p:spacer height="10px"/>
				<p:outputPanel id="charts">
					<p:panel rendered="#{chartBean.isChartSelected('consolePieChart')}" >
						<p:chart type="pie" model="#{chartBean.pieChart}" style="width:600px;height:300px;"/>
					</p:panel>
					
					<p:panel rendered="#{chartBean.isChartSelected('consoleBarChart')}">
						<p:chart type="bar" model="#{chartBean.barChart}" style="width:600px;height:300px;"/>					
					</p:panel>
				</p:outputPanel>
			</p:dialog>
			
			<p:dialog id="gameDialog" header="Gráficos para Jogos" widgetVar="gameDialogWidgetVar" modal="true" closeOnEscape="true" resizable="false">
				<h:panelGrid columns="2">
  
					<p:outputLabel value="Selecione o console: "/>
					<p:selectOneMenu value="#{chartBean.selectedChartOptionGame}">
						<f:selectItem itemLabel="Selecione..."/>
						<f:selectItems value="#{chartBean.listConsoles}" var="console" itemLabel="#{console.name}" itemValue="#{console.name}"/>
						<p:ajax update="genreCharts" process="@this"/>
					</p:selectOneMenu>
											
				</h:panelGrid>
					<p:outputPanel id="genreCharts">
						<p:panel rendered="#{chartBean.isChartSelectedGameGenre('Playstation 1')}">
							<p:chart type="bar" model="#{chartBean.barPS1Chart}" style="width:600px;height:300px;"/>
						</p:panel>
						
						<p:panel rendered="#{chartBean.isChartSelectedGameGenre('Playstation 2')}">
							<p:chart type="bar" model="#{chartBean.barPS2Chart}" style="width:600px;height:300px;"/>
						</p:panel>
						
						<p:panel rendered="#{chartBean.isChartSelectedGameGenre('Nintendo Ds')}">
							<p:chart type="bar" model="#{chartBean.barDSChart}" style="width:600px;height:300px;"/>
						</p:panel>
						
						<p:panel rendered="#{chartBean.isChartSelectedGameGenre('GBA')}">
							<p:chart type="bar" model="#{chartBean.barGBAChart}" style="width:600px;height:300px;"/>
						</p:panel>
						
						<p:panel rendered="#{chartBean.isChartSelectedGameGenre('SNES')}">
							<p:chart type="bar" model="#{chartBean.barSNESChart}" style="width:600px;height:300px;"/>
						</p:panel>
						
						<p:panel rendered="#{chartBean.isChartSelectedGameGenre('Nintendo 3Ds')}">
							<p:chart type="bar" model="#{chartBean.bar3DSChart}" style="width:600px;height:300px;"/>
						</p:panel>
					</p:outputPanel>
			</p:dialog>
		</h:form>
	</div>



</h:body>
</html>